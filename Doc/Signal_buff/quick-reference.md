# üìö Quick Reference - SignalBuffer API

## üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–∞

```cpp
// –ü—É—Å—Ç–æ–π –±—É—Ñ–µ—Ä
SignalBuffer buffer;

// –° –∑–∞–¥–∞–Ω–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ (256 –ª—É—á–µ–π √ó 8000 –æ—Ç—Å—á—ë—Ç–æ–≤)
SignalBuffer buffer(256, 8000);
```

## üìç –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º

### –°–ø–æ—Å–æ–± 1Ô∏è‚É£: –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ª—É—á (–ë–´–°–¢–†–û ‚ö°‚ö°‚ö°)

```cpp
auto* beam_data = buffer.GetBeamData(10);        // –õ—É—á 10
for (size_t s = 0; s < 8000; ++s) {
    auto value = beam_data[s];                   // –≠–ª–µ–º–µ–Ω—Ç [10][s]
    // ...
}
```

### –°–ø–æ—Å–æ–± 2Ô∏è‚É£: –≠–ª–µ–º–µ–Ω—Ç –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º (–£–î–û–ë–ù–û ‚ö°‚ö°)

```cpp
auto elem = buffer.GetElement(10, 100);          // –≠–ª–µ–º–µ–Ω—Ç [10][100]
buffer.SetElement(10, 100, value);               // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
```

### –°–ø–æ—Å–æ–± 3Ô∏è‚É£: –õ–∏–Ω–µ–π–Ω—ã–π –±—É—Ñ–µ—Ä (–î–õ–Ø GPU ‚ö°‚ö°‚ö°)

```cpp
auto& raw_data = buffer.GetRawData();            // std::vector<complex<float>>&
auto elem = raw_data[80100];                     // –õ–∏–Ω–µ–π–Ω—ã–π –¥–æ—Å—Ç—É–ø
```

## üéØ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

```cpp
size_t num_beams = buffer.GetNumBeams();         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—É—á–µ–π
size_t num_samples = buffer.GetNumSamples();     // –û—Ç—Å—á—ë—Ç–æ–≤ –Ω–∞ –ª—É—á
bool valid = buffer.IsValid();                   // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å
```

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```cpp
buffer.Resize(256, 8000);                        // –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä
buffer.Clear();                                   // –û—á–∏—Å—Ç–∏—Ç—å –±—É—Ñ–µ—Ä
```

## üíæ –í–≤–æ–¥/–í—ã–≤–æ–¥

```cpp
buffer.SaveToFile("data.bin");                   // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
buffer.LoadFromFile("data.bin");                 // –ó–∞–≥—Ä—É–∑–∏—Ç—å
```

---

## üåä –õ–ß–ú –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å –¥—Ä–æ–±–Ω—ã–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏

```cpp
#include "lfm_signal_generator.h"

// –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
LFMSignalGenerator lfm(
    f_start,      // 100 –ì—Ü
    f_stop,       // 500 –ì—Ü
    sample_rate,  // 8000 –ì—Ü
    duration      // 1.0 —Å–µ–∫
);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –ª—É—á–∏
std::vector<std::complex<float>*> beam_ptrs(num_beams);
for (size_t i = 0; i < num_beams; ++i) {
    beam_ptrs[i] = buffer.GetBeamData(i);
}

// –î—Ä–æ–±–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ (0.0, 0.125, 0.25, 0.375, ...)
std::vector<float> delays(num_beams);
for (size_t i = 0; i < num_beams; ++i) {
    delays[i] = i * 0.125f;  // ‚ú® –î–†–û–ë–ù–´–ï!
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
lfm.GenerateAllBeams(beam_ptrs, num_samples, num_beams, delays);
```

---

## üöÄ GPU –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (OpenCL)

```cpp
// –ü–æ–ª—É—á–∏—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ
auto& raw_data = buffer.GetRawData();

// –°–æ–∑–¥–∞—Ç—å GPU –±—É—Ñ–µ—Ä
cl_mem gpu_buffer = clCreateBuffer(
    context,
    CL_MEM_COPY_HOST_PTR,
    raw_data.size() * sizeof(std::complex<float>),
    raw_data.data(),  // ‚Üê –ü—Ä—è–º–æ–π —É–∫–∞–∑–∞—Ç–µ–ª—å!
    nullptr
);

// –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
clEnqueueWriteBuffer(queue, gpu_buffer, CL_TRUE, 0,
                     raw_data.size() * sizeof(std::complex<float>),
                     raw_data.data(), 0, nullptr, nullptr);
```

---

## üìä –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

```cpp
// –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —á–∏—Å–ª–∞
using ComplexType = std::complex<float>;

// –î–æ—Å—Ç—É–ø –∫ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∏ –º–Ω–∏–º–æ–π —á–∞—Å—Ç—è–º
ComplexType val = buffer.GetElement(b, s);
float real_part = val.real();
float imag_part = val.imag();
```

---

## üîç –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

| –í–æ–ø—Ä–æ—Å | –û—Ç–≤–µ—Ç |
|--------|--------|
| **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞ –ª–∏?** | ‚ùå –ù–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ mutex –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ |
| **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏ –≥—Ä–∞–Ω–∏—Ü—ã?** | ‚úÖ –î–∞. –í—Å–µ –º–µ—Ç–æ–¥—ã –±–µ–∑–æ–ø–∞—Å–Ω—ã |
| **–°–æ–≤–º–µ—Å—Ç–∏–º–∞ –ª–∏ —Å GPU?** | ‚úÖ –î–∞. –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å OpenCL/CUDA |
| **–î—Ä–æ–±–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏?** | ‚úÖ –î–∞. –° –ª–∏–Ω–µ–π–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–µ–π |
| **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å?** | ‚úÖ –î–∞. –°—Ç–∞—Ä—ã–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π |

---

## ‚ú® –ò–Ω–¥–µ–∫—Å: –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –¥–æ—Å—Ç—É–ø–∞

```cpp
// –î–û (–∏–Ω–¥–µ–∫—Å - –¥–≤—É–º–µ—Ä–Ω—ã–π):
std::complex<float> x = buffer_2d[10][100];

// –ü–û–°–õ–ï (–¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ - –æ–±–∞ —Ä–∞–±–æ—Ç–∞—é—Ç):

// –°–ø–æ—Å–æ–± –ê: –ß–µ—Ä–µ–∑ –∏–Ω–¥–µ–∫—Å—ã
std::complex<float> x = buffer.GetElement(10, 100);

// –°–ø–æ—Å–æ–± –ë: –ß–µ—Ä–µ–∑ –ª–∏–Ω–µ–π–Ω—ã–π –∏–Ω–¥–µ–∫—Å
// linear_index = 10 * 8000 + 100 = 80100
std::complex<float> x = buffer.GetRawData()[80100];
```

---

## üéì –ü—Ä–∏–º–µ—Ä—ã –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

### –ù–∞—á–∏–Ω–∞—é—â–∏–π

```cpp
#include "signal_buffer.h"

SignalBuffer buffer(256, 8000);
auto elem = buffer.GetElement(10, 100);
std::cout << elem.real() << " + j" << elem.imag() << "\n";
```

### –°—Ä–µ–¥–Ω–∏–π

```cpp
#include "signal_buffer.h"
#include "lfm_signal_generator.h"

LFMSignalGenerator lfm(100, 500, 8000, 1.0);
SignalBuffer buffer(256, 8000);

std::vector<std::complex<float>*> ptrs(256);
for (size_t i = 0; i < 256; ++i) {
    ptrs[i] = buffer.GetBeamData(i);
}

lfm.GenerateAllBeams(ptrs, 8000, 256);
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π

```cpp
// –° –¥—Ä–æ–±–Ω—ã–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏ –∏ GPU
std::vector<float> delays(256);
for (size_t i = 0; i < 256; ++i) {
    delays[i] = i * 0.1f;  // –î—Ä–æ–±–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏!
}

lfm.GenerateAllBeams(ptrs, 8000, 256, delays);

auto& raw = buffer.GetRawData();
clEnqueueWriteBuffer(queue, gpu_buffer, CL_TRUE, 0,
                     raw.size() * sizeof(std::complex<float>),
                     raw.data(), 0, nullptr, nullptr);
```

---

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (256√ó8000)

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|-------|-----------|
| GetElement() | ~15 –Ω—Å | –° –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≥—Ä–∞–Ω–∏—Ü |
| –£–∫–∞–∑–∞—Ç–µ–ª—å –ª—É—á–∞ | ~5 –Ω—Å | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ |
| –õ–∏–Ω–µ–π–Ω—ã–π –¥–æ—Å—Ç—É–ø | ~8 –Ω—Å | –î–ª—è GPU |
| –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ GPU | ~28 –º—Å | PCIe 3.0 x16 |

---

## üîó –ö–æ–º–ø–∏–ª—è—Ü–∏—è

```bash
# Linux/Mac
g++ -std=c++17 -O3 main.cpp signal_buffer.cpp lfm_signal_generator.cpp

# Windows (MSVC)
cl /std:c++17 /O2 main.cpp signal_buffer.cpp lfm_signal_generator.cpp

# –° OpenCL
g++ -std=c++17 -O3 main.cpp signal_buffer.cpp lfm_signal_generator.cpp -lOpenCL
```

---

## üêõ –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

### ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û

```cpp
// –ó–∞–±—ã–ª —Å–∫–æ–±–∫–∏
auto val = buffer.GetElement(10, 100);  // ‚úì OK
// auto val = buffer.GetElement[10][100];  // ‚úó ERROR!

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ API (–µ—Å–ª–∏ –æ–Ω –±—ã–ª —É–¥–∞–ª–µ–Ω)
// auto val = buffer[10][100];  // ‚úó ERROR! (2D –≤–µ–∫—Ç–æ—Ä –±–æ–ª—å—à–µ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω)
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

```cpp
// –°–ø–æ—Å–æ–± 1: GetElement
auto val = buffer.GetElement(10, 100);

// –°–ø–æ—Å–æ–± 2: GetBeamData
auto* beam = buffer.GetBeamData(10);
auto val = beam[100];

// –°–ø–æ—Å–æ–± 3: GetRawData
auto& raw = buffer.GetRawData();
auto val = raw[80100];  // 10*8000+100
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

- [ ] –í–∫–ª—é—á–µ–Ω `#include "signal_buffer.h"`
- [ ] –ë—É—Ñ–µ—Ä —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å: `buffer.IsValid()`
- [ ] –î–∞–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã (–∏–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã)
- [ ] –ò–Ω–¥–µ–∫—Å—ã –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥—Ä–∞–Ω–∏—Ü

---

## üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

| –î–æ–∫—É–º–µ–Ω—Ç | –î–ª—è –∫–æ–≥–æ |
|----------|----------|
| **README.md** | –û–±–∑–æ—Ä –∏ –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç |
| **USAGE_EXAMPLES.md** | –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã |
| **ARCHITECTURE_COMPARISON.md** | –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã |
| **REFACTORING_SUMMARY.md** | –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ |

---

## üí° –°–æ–≤–µ—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–î–ª—è —Ü–∏–∫–ª–æ–≤** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `GetBeamData()` –æ–¥–∏–Ω —Ä–∞–∑
2. **–î–ª—è GPU** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `GetRawData().data()`
3. **–î–ª—è –æ—Ç–ª–∞–¥–∫–∏** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `GetElement()` (—Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏)
4. **–î–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `LoadFromFile()`/`SaveToFile()`

---

**–ü–∞–º—è—Ç–∫–∞**: –í—Å–µ –º–µ—Ç–æ–¥—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `Get` - —ç—Ç–æ —á—Ç–µ–Ω–∏–µ (–Ω–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç). –ú–µ—Ç–æ–¥—ã —Ç–∏–ø–∞ `Set` –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ `Resize`, `Clear` - —ç—Ç–æ –∑–∞–ø–∏—Å—å (–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç).

---

**–í–µ—Ä—Å–∏—è**: 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2 —è–Ω–≤–∞—Ä—è 2026  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
