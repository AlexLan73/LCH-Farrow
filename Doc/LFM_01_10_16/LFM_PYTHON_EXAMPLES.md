# üêç Python: –ü—Ä–∏–º–µ—Ä—ã –∏ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

## –ü–†–ò–ú–ï–† 1: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ó–∞–¥–µ—Ä–∂–∫–∏ –ø–æ –£–≥–ª–∞–º

```python
import numpy as np
import matplotlib.pyplot as plt

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ü–ê–†–ê–ú–ï–¢–†–´
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

c = 3e8                    # –°–∫–æ—Ä–æ—Å—Ç—å —Å–≤–µ—Ç–∞ (–º/—Å)
f_center = 1.5e6           # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ (1.5 –ú–ì—Ü) ‚Äî –±–∞–∑–æ–≤–∞—è –ø–æ–ª–æ—Å–∞!
wavelength = c / f_center  # –î–ª–∏–Ω–∞ –≤–æ–ª–Ω—ã
d = wavelength / 2         # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ (Œª/2)

f_s = 12e6                 # –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ (12 –ú–ì—Ü)

num_elements = 8           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Ä–µ—à—ë—Ç–∫–µ
num_angles = 121           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≥–ª–æ–≤ (–æ—Ç -60¬∞ –¥–æ +60¬∞ —Å —à–∞–≥–æ–º 1¬∞)

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ì–ï–ù–ï–†–ê–¶–ò–Ø –£–ì–õ–û–í –ò –í–´–ß–ò–°–õ–ï–ù–ò–ï –ó–ê–î–ï–†–ñ–ï–ö
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

angles_deg = np.linspace(-60, 60, num_angles)  # –£–≥–ª—ã –≤ –≥—Ä–∞–¥—É—Å–∞—Ö
angles_rad = np.deg2rad(angles_deg)             # –£–≥–ª—ã –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö

# –°–æ–∑–¥–∞—ë–º –º–∞—Ç—Ä–∏—Ü—É –∑–∞–¥–µ—Ä–∂–µ–∫: [num_elements, num_angles]
delays_matrix = np.zeros((num_elements, num_angles))

for elem_idx in range(num_elements):
    for angle_idx, angle_rad in enumerate(angles_rad):
        # –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ (—Ñ–æ—Ä–º—É–ª–∞)
        element_pos = elem_idx * d
        delay_time = (element_pos * np.sin(angle_rad)) / c  # —Å–µ–∫
        delay_samples = delay_time * f_s                     # –æ—Ç—Å—á—ë—Ç—ã
        delays_matrix[elem_idx, angle_idx] = delay_samples

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

plt.figure(figsize=(14, 8))

# –ì—Ä–∞—Ñ–∏–∫ 1: –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∑–∞–¥–µ—Ä–∂–µ–∫
plt.subplot(2, 2, 1)
im = plt.imshow(delays_matrix, aspect='auto', cmap='viridis', 
                extent=[angles_deg[0], angles_deg[-1], num_elements-1, 0])
plt.colorbar(im, label='–ó–∞–¥–µ—Ä–∂–∫–∞ (–æ—Ç—Å—á—ë—Ç—ã)')
plt.xlabel('–£–≥–æ–ª (–≥—Ä–∞–¥—É—Å—ã)')
plt.ylabel('–ò–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞')
plt.title('–ú–∞—Ç—Ä–∏—Ü–∞ –ó–∞–¥–µ—Ä–∂–µ–∫ –ø–æ –£–≥–ª–∞–º')
plt.grid(True, alpha=0.3)

# –ì—Ä–∞—Ñ–∏–∫ 2: –ó–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (—Ñ—É–Ω–∫—Ü–∏—è –æ—Ç —É–≥–ª–∞)
plt.subplot(2, 2, 2)
elem = 3  # 4-–π —ç–ª–µ–º–µ–Ω—Ç
plt.plot(angles_deg, delays_matrix[elem, :], 'b-', linewidth=2)
plt.xlabel('–£–≥–æ–ª (–≥—Ä–∞–¥—É—Å—ã)')
plt.ylabel('–ó–∞–¥–µ—Ä–∂–∫–∞ (–æ—Ç—Å—á—ë—Ç—ã)')
plt.title(f'–ó–∞–¥–µ—Ä–∂–∫–∞ –≠–ª–µ–º–µ–Ω—Ç–∞ {elem} –æ—Ç –£–≥–ª–∞')
plt.grid(True)

# –ì—Ä–∞—Ñ–∏–∫ 3: –§–∞–∑–æ–≤—ã–π —Å–¥–≤–∏–≥ (–∏–∑ –∑–∞–¥–µ—Ä–∂–∫–∏)
plt.subplot(2, 2, 3)
f_carrier = 1.5e6  # –ù–µ—Å—É—â–∞—è —á–∞—Å—Ç–æ—Ç–∞
phase_shifts = 2 * np.pi * f_carrier * (delays_matrix / f_s)
plt.plot(angles_deg, np.degrees(phase_shifts[0, :]), label='–≠–ª–µ–º–µ–Ω—Ç 0')
plt.plot(angles_deg, np.degrees(phase_shifts[3, :]), label='–≠–ª–µ–º–µ–Ω—Ç 3')
plt.plot(angles_deg, np.degrees(phase_shifts[7, :]), label='–≠–ª–µ–º–µ–Ω—Ç 7')
plt.xlabel('–£–≥–æ–ª (–≥—Ä–∞–¥—É—Å—ã)')
plt.ylabel('–§–∞–∑–æ–≤—ã–π —Å–¥–≤–∏–≥ (–≥—Ä–∞–¥—É—Å—ã)')
plt.title('–§–∞–∑–æ–≤—ã–π –°–¥–≤–∏–≥ vs –£–≥–æ–ª')
plt.legend()
plt.grid(True)

# –ì—Ä–∞—Ñ–∏–∫ 4: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
plt.subplot(2, 2, 4)
plt.axis('off')
info_text = f"""
–ü–ê–†–ê–ú–ï–¢–†–´ –°–ò–°–¢–ï–ú–´:

–ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏: {f_s/1e6:.1f} –ú–ì—Ü
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞: {f_center/1e6:.1f} –ú–ì—Ü
–î–ª–∏–Ω–∞ –≤–æ–ª–Ω—ã: {wavelength:.3f} –º
–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏: {d:.3f} –º

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: {num_elements}
–î–∏–∞–ø–∞–∑–æ–Ω —É–≥–ª–æ–≤: -60¬∞ –¥–æ +60¬∞
–®–∞–≥ —É–≥–ª–æ–≤: {360/num_angles:.1f}¬∞

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: {np.max(delays_matrix):.2f} –æ—Ç—Å—á—ë—Ç–æ–≤
–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: {np.min(delays_matrix):.2f} –æ—Ç—Å—á—ë—Ç–æ–≤
"""
plt.text(0.1, 0.5, info_text, fontsize=11, family='monospace',
         verticalalignment='center')

plt.tight_layout()
plt.savefig('delay_vs_angle.png', dpi=150, bbox_inches='tight')
plt.show()

print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ '–ó–∞–¥–µ—Ä–∂–∫–∞ vs –£–≥–æ–ª' —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ delay_vs_angle.png")
```

---

## –ü–†–ò–ú–ï–† 2: –ì–µ—Ç–µ—Ä–æ–¥–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –£–º–Ω–æ–∂–µ–Ω–∏–µ)

```python
import numpy as np
import matplotlib.pyplot as plt

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ü–ê–†–ê–ú–ï–¢–†–´ –õ–ß–ú –°–ò–ì–ù–ê–õ–ê
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

f_0 = 1.0e6          # –ù–∞—á–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ (1 –ú–ì—Ü)
f_1 = 2.0e6          # –ö–æ–Ω–µ—á–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ (2 –ú–ì—Ü)
f_s = 12.0e6         # –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ (12 –ú–ì—Ü)
T_duration = 0.01    # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (10 –º—Å)

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –õ–ß–ú
chirp_rate = (f_1 - f_0) / T_duration  # Hz/sec
num_samples = int(T_duration * f_s)
t = np.arange(num_samples) / f_s

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ì–ï–ù–ï–†–ê–¶–ò–Ø –°–ò–ì–ù–ê–õ–û–í
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# –§–∞–∑–∞ –õ–ß–ú: œÜ(t) = 2œÄ(f_0¬∑t + (Œº/2)¬∑t¬≤), –≥–¥–µ Œº = (f_1-f_0)/T
phase_lfm = 2 * np.pi * (f_0 * t + 0.5 * chirp_rate * t**2)

# –û–ø–æ—Ä–Ω—ã–π —Å–∏–≥–Ω–∞–ª (—Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –õ–ß–ú)
s_ref = np.exp(1j * phase_lfm)

# –°–æ–ø—Ä—è–∂—ë–Ω–Ω—ã–π –æ–ø–æ—Ä–Ω—ã–π —Å–∏–≥–Ω–∞–ª (–≥–µ—Ç–µ—Ä–æ–¥–∏–Ω)
s_ref_conj = np.conj(s_ref)

# –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–∏—ë–º–Ω—ã–π —Å–∏–≥–Ω–∞–ª (–∑–∞–¥–µ—Ä–∂–∞–Ω –Ω–∞ 2 –º—Å, –æ—Å–ª–∞–±–ª–µ–Ω)
delay_samples = int(0.002 * f_s)  # 2 –º—Å = 24000 –æ—Ç—Å—á—ë—Ç–æ–≤
attenuation = 0.7
s_rx = np.concatenate([np.zeros(delay_samples), 
                       attenuation * s_ref[:-delay_samples]])

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ì–ï–¢–ï–†–û–î–ò–ù–ò–†–û–í–ê–ù–ò–ï
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# y[n] = s_rx[n] * s_ref_conj[n]
y_heterodyne = s_rx * s_ref_conj

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ê–ù–ê–õ–ò–ó –°–ü–ï–ö–¢–†–ê (–ë–ü–§)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# –ë–ü–§ –ø—Ä–∏—ë–º–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
Y_rx = np.fft.fft(s_rx)
freq_rx = np.fft.fftfreq(num_samples, 1/f_s)

# –ë–ü–§ –≥–µ—Ç–µ—Ä–æ–¥–∏–Ω–∞
Y_het = np.fft.fft(y_heterodyne)
freq_het = np.fft.fftfreq(num_samples, 1/f_s)

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

fig, axes = plt.subplots(3, 2, figsize=(15, 10))

# –í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–æ–º–µ–Ω: –ü—Ä–∏—ë–º–Ω—ã–π —Å–∏–≥–Ω–∞–ª (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å)
axes[0, 0].plot(t[::100] * 1000, np.real(s_rx[::100]), 'b-', linewidth=1)
axes[0, 0].set_xlabel('–í—Ä–µ–º—è (–º—Å)')
axes[0, 0].set_ylabel('–ê–º–ø–ª–∏—Ç—É–¥–∞')
axes[0, 0].set_title('–ü—Ä–∏—ë–º–Ω—ã–π –°–∏–≥–Ω–∞–ª (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å)')
axes[0, 0].grid(True)

# –í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–æ–º–µ–Ω: –û–ø–æ—Ä–Ω—ã–π —Å–∏–≥–Ω–∞–ª
axes[0, 1].plot(t[::100] * 1000, np.real(s_ref[::100]), 'g-', linewidth=1)
axes[0, 1].set_xlabel('–í—Ä–µ–º—è (–º—Å)')
axes[0, 1].set_ylabel('–ê–º–ø–ª–∏—Ç—É–¥–∞')
axes[0, 1].set_title('–û–ø–æ—Ä–Ω—ã–π –õ–ß–ú (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å)')
axes[0, 1].grid(True)

# –í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–æ–º–µ–Ω: –ì–µ—Ç–µ—Ä–æ–¥–∏–Ω–∞ (–∞–º–ø–ª–∏—Ç—É–¥–∞)
axes[1, 0].plot(t[::100] * 1000, np.abs(y_heterodyne[::100]), 'r-', linewidth=1)
axes[1, 0].set_xlabel('–í—Ä–µ–º—è (–º—Å)')
axes[1, 0].set_ylabel('–ê–º–ø–ª–∏—Ç—É–¥–∞')
axes[1, 0].set_title('–ì–µ—Ç–µ—Ä–æ–¥–∏–Ω - –ê–º–ø–ª–∏—Ç—É–¥–∞ (—Å–∂–∞—Ç—ã–π –∏–º–ø—É–ª—å—Å)')
axes[1, 0].grid(True)

# –í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–æ–º–µ–Ω: –ì–µ—Ç–µ—Ä–æ–¥–∏–Ω–∞ (—Ñ–∞–∑–∞)
phase_het = np.unwrap(np.angle(y_heterodyne))
axes[1, 1].plot(t[::100] * 1000, phase_het[::100], 'purple', linewidth=1)
axes[1, 1].set_xlabel('–í—Ä–µ–º—è (–º—Å)')
axes[1, 1].set_ylabel('–§–∞–∑–∞ (—Ä–∞–¥–∏–∞–Ω—ã)')
axes[1, 1].set_title('–ì–µ—Ç–µ—Ä–æ–¥–∏–Ω - –§–∞–∑–∞ (—Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–∞—è)')
axes[1, 1].grid(True)

# –°–ø–µ–∫—Ç—Ä: –ü—Ä–∏—ë–º–Ω—ã–π —Å–∏–≥–Ω–∞–ª
axes[2, 0].semilogy(freq_rx[:num_samples//2] / 1e6, 
                    np.abs(Y_rx[:num_samples//2]), 'b-', linewidth=0.5)
axes[2, 0].set_xlabel('–ß–∞—Å—Ç–æ—Ç–∞ (–ú–ì—Ü)')
axes[2, 0].set_ylabel('–ê–º–ø–ª–∏—Ç—É–¥–∞ (–ª–æ–≥–∞—Ä–∏—Ñ–º)')
axes[2, 0].set_title('–°–ø–µ–∫—Ç—Ä –ü—Ä–∏—ë–º–Ω–æ–≥–æ –°–∏–≥–Ω–∞–ª–∞')
axes[2, 0].grid(True)
axes[2, 0].set_xlim([0, 6])

# –°–ø–µ–∫—Ç—Ä: –ü–æ—Å–ª–µ –≥–µ—Ç–µ—Ä–æ–¥–∏–Ω–∞
axes[2, 1].semilogy(freq_het[:num_samples//2] / 1e6, 
                    np.abs(Y_het[:num_samples//2]), 'r-', linewidth=0.5)
axes[2, 1].set_xlabel('–ß–∞—Å—Ç–æ—Ç–∞ (–ú–ì—Ü)')
axes[2, 1].set_ylabel('–ê–º–ø–ª–∏—Ç—É–¥–∞ (–ª–æ–≥–∞—Ä–∏—Ñ–º)')
axes[2, 1].set_title('–°–ø–µ–∫—Ç—Ä –ü–æ—Å–ª–µ –ì–µ—Ç–µ—Ä–æ–¥–∏–Ω–∞ (—Å–∂–∞—Ç –≤ baseband)')
axes[2, 1].grid(True)
axes[2, 1].set_xlim([-3, 3])

plt.tight_layout()
plt.savefig('heterodyne_analysis.png', dpi=150, bbox_inches='tight')
plt.show()

print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ '–ê–Ω–∞–ª–∏–∑ –ì–µ—Ç–µ—Ä–æ–¥–∏–Ω–∞' —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ heterodyne_analysis.png")
print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:")
print(f"  ‚Ä¢ –ü—Ä–∏—ë–º–Ω—ã–π —Å–∏–≥–Ω–∞–ª: –õ–ß–ú –æ—Ç {f_0/1e6:.1f} –ú–ì—Ü –¥–æ {f_1/1e6:.1f} –ú–ì—Ü")
print(f"  ‚Ä¢ –ü–æ—Å–ª–µ –≥–µ—Ç–µ—Ä–æ–¥–∏–Ω–∞: —ç–Ω–µ—Ä–≥–∏—è —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –≤ baseband (0 –ú–ì—Ü)")
print(f"  ‚Ä¢ –ü–∏–∫ –≤ —Å–ø–µ–∫—Ç—Ä–µ: –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ {delay_samples/f_s*1000:.2f} –º—Å (–∑–∞–¥–µ—Ä–∂–∫–∞)")
```

---

## –ü–†–ò–ú–ï–† 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ GPU (Pseudocode)

```cpp
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –û–°–ù–û–í–ù–û–ô –ê–õ–ì–û–†–ò–¢–ú –î–õ–Ø GPU (OpenCL/CUDA)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

/*

–®–ê–ì–ò:

1. –ù–∞ CPU: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–ø–æ—Ä–Ω—ã–π –õ–ß–ú (s_ref)
   ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ–º LFMSignalGenerator::Generate(BASIC)
   ‚Ä¢ –ö–æ–ø–∏—Ä—É–µ–º –≤ GPU –ø–∞–º—è—Ç—å

2. –ù–∞ CPU: –í—ã—á–∏—Å–ª—è–µ–º –º–∞—Ç—Ä–∏—Ü—É –∑–∞–¥–µ—Ä–∂–µ–∫ –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —É–≥–ª–æ–≤ (0.5¬∞ —à–∞–≥)
   ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ–º ComputeDelayForAngle() –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
   ‚Ä¢ –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ GPU

3. –ù–∞ GPU (kernel): –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª—É—á–∞
   a. –í—ã—á–∏—Å–ª—è–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è —É–≥–ª–∞ Œ∏_i
   b. –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—é –õ–∞–≥—Ä–∞–Ω–∂–∞ (–∫–∞–∫ —É —Ç–µ–±—è!)
   c. –ü–æ–ª—É—á–∞–µ–º —Å–∏–≥–Ω–∞–ª –¥–ª—è —ç—Ç–æ–≥–æ –ª—É—á–∞: beam_i[n]

4. –ù–∞ GPU: –ì–µ—Ç–µ—Ä–æ–¥–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
   ‚Ä¢ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª—É—á–∞: y_i[n] = beam_i[n] * conj(s_ref[n])
   ‚Ä¢ –ú–æ–∂–Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º kernel

5. –ù–∞ GPU: –ë–ü–§ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞
   ‚Ä¢ FFT(y_i[n]) ‚Üí —Å–ø–µ–∫—Ç—Ä –≤ baseband
   ‚Ä¢ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π, –æ—Ü–µ–Ω–∫–∞ –¥–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –î–æ–ø–ª–µ—Ä–∞

6. –ù–∞ CPU: –ö–æ–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞—Ç–Ω–æ

*/

// –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ kernel:

__kernel void beamform_with_delay(
    __global float2* rx_data,           // –ü—Ä–∏—ë–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    __global float2* ref_lfm,           // –û–ø–æ—Ä–Ω—ã–π –õ–ß–ú
    __global float* delays_matrix,      // –ú–∞—Ç—Ä–∏—Ü–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ [num_elem, num_beams]
    __global float* lagrange_coeffs,    // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –õ–∞–≥—Ä–∞–Ω–∂–∞
    uint num_samples,
    uint num_elements,
    uint num_beams,
    __global float2* output             // –í—ã—Ö–æ–¥ [num_beams, num_samples]
) {
    uint beam_idx = get_global_id(0);
    uint sample_idx = get_global_id(1);
    
    if (beam_idx >= num_beams || sample_idx >= num_samples) return;
    
    float2 acc = (float2)(0.0f, 0.0f);
    
    // –°—É–º–º–∏—Ä—É–µ–º –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
    for (uint elem = 0; elem < num_elements; ++elem) {
        // –ü–æ–ª—É—á–∞–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –ª—É—á–∞
        float delay_samples = delays_matrix[elem * num_beams + beam_idx];
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—é –õ–∞–≥—Ä–∞–Ω–∂–∞ (–∫–∞–∫ –≤ —Ç–≤–æ—ë–º kernel!)
        int delay_int = (int)delay_samples;
        float delay_frac = delay_samples - delay_int;
        
        // –í—ã–±–æ—Ä–∫–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏
        uint idx = sample_idx + delay_int;
        if (idx < num_samples) {
            float2 sample = rx_data[elem * num_samples + idx];
            
            // –ó–¥–µ—Å—å –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –õ–∞–≥—Ä–∞–Ω–∂–∞ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è
            // (—Ç–≤–æ—è —Ñ—É–Ω–∫—Ü–∏—è lagrange_interpolate)
            float2 interpolated = lagrange_interpolate(
                sample, delay_frac, lagrange_coeffs
            );
            
            acc += interpolated;
        }
    }
    
    // –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å—É–º–º–∞ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (beamforming)
    output[beam_idx * num_samples + sample_idx] = acc;
}

// –ì–µ—Ç–µ—Ä–æ–¥–∏–Ω kernel:

__kernel void heterodyne(
    __global float2* signal,            // –í—Ö–æ–¥–Ω–æ–π —Å–∏–≥–Ω–∞–ª
    __global float2* ref_lfm,           // –û–ø–æ—Ä–Ω—ã–π –õ–ß–ú
    uint num_samples,
    __global float2* output             // –í—ã—Ö–æ–¥
) {
    uint idx = get_global_id(0);
    
    if (idx >= num_samples) return;
    
    float2 sig = signal[idx];
    float2 ref = ref_lfm[idx];
    
    // –°–æ–ø—Ä—è–∂–µ–Ω–∏–µ –æ–ø–æ—Ä–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
    float2 ref_conj = (float2)(ref.x, -ref.y);
    
    // –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ: y = sig * ref_conj
    float2 result;
    result.x = sig.x * ref_conj.x - sig.y * ref_conj.y;
    result.y = sig.x * ref_conj.y + sig.y * ref_conj.x;
    
    output[idx] = result;
}

```

---

## –ß–ï–ö–õ–ò–°–¢ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

```
‚úì –¢–µ–æ—Ä–∏—è –ø–æ–Ω—è—Ç–∞ (—Ñ–æ—Ä–º—É–ª—ã –∑–∞–¥–µ—Ä–∂–∫–∏)
‚úì –ö–æ–¥ –º–µ—Ç–æ–¥–æ–≤ –Ω–∞–ø–∏—Å–∞–Ω (ComputeDelayForAngle, MakeConjugateCopy –∏ —Ç.–¥.)
‚úì Enum LFMVariant —Ä–∞—Å—à–∏—Ä–µ–Ω (ANGLE_SWEEP, HETERODYNE)
‚úì Struct LFMParameters –æ–±–Ω–æ–≤–ª—ë–Ω (—É–≥–ª—ã)
‚úì GenerateIntoBuffer –¥–æ–ø–æ–ª–Ω–µ–Ω (–Ω–æ–≤—ã–µ –≤–µ—Ç–∫–∏ switch)
‚úì Python –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
‚úì GPU kernel –ø–µ—Ä–µ–¥–µ–ª–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ç—Ä–∏—Ü–µ–π –∑–∞–¥–µ—Ä–∂–µ–∫
‚úì –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–î–ê–õ–¨–®–ï:
‚Üí –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –≤ —Ç–≤–æ–π main.cpp
‚Üí –ü–æ–¥–∫–ª—é—á–∏—Ç—å GPU kernel
‚Üí –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚Üí –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –õ–∞–≥—Ä–∞–Ω–∂–∞ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—é
```

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–Ø–∑—ã–∫:** Python 3.8+  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** numpy, matplotlib  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É
